{% extends "base.html" %}
{% block head %}
	<title>Contact Form</title>
{% endblock %}
{% block style %}
{% endblock %}
{% block content %}
	<div class="container">
		<div class="jumbotron">
			<h1 class="text-center display-4">Contact Form[CBV]</h1>
			<p class="lead text-center">This is a sample example for integration of AJAX with Django</p>
		</div>
		<div class="row justify-content-center align-items-center">
			<div class="col-sm-6 ">
				<form id = "contactForm" method = "POST">{% csrf_token %}
                <div id="success_message"></div>
					{{ contactForm.as_p }}
					<input type="submit" name="contact-submit" class="btn btn-primary" />
				</form>
			</div>
		</div>
	</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
	$(document).ready(function(){
		$("#contactForm").submit(function(e){
			e.preventDefault();
			var serializedData = $(this).serialize();
			$.ajax({
				type : 'POST',
				url :  "{% url 'core:contact_submit_cbv' %}",
				data : serializedData,
				success : function(response){ 
					$("#contactForm")[0].reset();
                    $("#success_message").html(
                        `<div class="alert alert-success text-center p-4 mb-3" role="alert">
                        ${response.success_message}
                        </div>`
                    );

					// $(this)[0].reset(); // This logs an error but the form still works
				},
				error : function(response){
					console.log(response);
				}
			})
		})
	})
</script>
{% endblock %}